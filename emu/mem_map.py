from .utils import dummy_map, mirror_map

# memory regions
ROM1_ADDR =         0x0
ROM1_REMAP_ADDR =   0x20000000
ROM2_ADDR =         0x04000000
ROM2_REMAP_ADDR =   0x24000000
ROM_LENGHT = 0x800000

RAM_ADDR = 0x40000000
RAM_REMAP0_ADDR = 0x50000000
RAM_REMAP1_ADDR = 0x60000000
RAM_REMAP2_ADDR = 0x70000000
RAM_LENGHT = 128 * (1024 * 1024) # 128 MB

#TCM:
#  instr TCM of 32KB at 80000000
#  data TCM of 4KB at 0x80008000
INSTR_TCM_ADDR = 0x80000000
INSTR_TCM_LENGHT = 32 * (1024) # 32 KB

DATA_TCM_ADDR = 0x80008000
DATA_TCM_LENGHT = 4 * (1024) # 4 KB

CORE_ADDR = 0xd0000000
CORE_LENGHT = 0x400000

IO_UNK0_ADDR = 0xd0400000
IO_UNK0_LENGHT = 0x2000

IO_EHCI_HOST_ADDR = 0xd0802000
IO_EHCI_HOST_LENGHT = 0x1000

IO_UNK5_ADDR = 0xe0001000
IO_UNK5_LENGHT = 0x1000

IO_UNK9_ADDR = 0xe0003000
IO_UNK9_LENGHT = 0x1000

IO_EHCI_ADDR = 0xe0800000
IO_EHCI_LENGHT = 0x1000

IO_UNK1_ADDR = 0xe0812000
IO_UNK1_LENGHT = 0x1000

IO_SERIAL_ADDR = 0xe0816000
IO_SERIAL_LENGHT = 0x1000

IO_UNK2_ADDR = 0xe0817000
IO_UNK2_LENGHT = 0x1000

IO_UNK6_ADDR = 0xe0819000
IO_UNK6_LENGHT = 0x1000

IO_UNK7_ADDR = 0xe081a000
IO_UNK7_LENGHT = 0x1000

MSG_RAM_ADDR = 0xe0c00000
MSG_RAM_LENGHT = 0x4000

IO_UNK3_ADDR = 0xf0000000
IO_UNK3_LENGHT = 0x1000

IO_UNKF0071_ADDR = 0xf0071000
IO_UNKF0071_LENGHT =   0x1000

INT_REGS_ADDR = 0xf0080000
INT_REGS_LENGHT = 0x1000

IO_UNK8_ADDR = 0xf0084000
IO_UNK8_LENGHT = 0x1000

IO_UNK4_ADDR = 0xf0081000
IO_UNK4_LENGHT = 0x1000

SFLU3_ADDR = 0xf0088000
SFLU3_LENGHT = 0x1000

def map_memory(mc):
    mc.mem_map(RAM_ADDR, RAM_LENGHT)
    mirror_map(mc, RAM_REMAP0_ADDR, RAM_LENGHT, RAM_ADDR)
    mirror_map(mc, RAM_REMAP1_ADDR, RAM_LENGHT, RAM_ADDR)
    mirror_map(mc, RAM_REMAP2_ADDR, RAM_LENGHT, RAM_ADDR)
    mc.mem_map(INSTR_TCM_ADDR, INSTR_TCM_LENGHT)
    mc.mem_map(DATA_TCM_ADDR, DATA_TCM_LENGHT)
    mc.mem_map(CORE_ADDR, CORE_LENGHT)
    dummy_map(mc, "IO_UNK0", IO_UNK0_ADDR, IO_UNK0_LENGHT)
    dummy_map(mc, "IO_UNK5", IO_UNK5_ADDR, IO_UNK5_LENGHT)
    dummy_map(mc, "IO_UNK9", IO_UNK9_ADDR, IO_UNK9_LENGHT)
    dummy_map(mc, "IO_EHCI_HOST", IO_EHCI_HOST_ADDR, IO_EHCI_HOST_LENGHT)
    dummy_map(mc, "IO_EHCI", IO_EHCI_ADDR, IO_EHCI_LENGHT)
    dummy_map(mc, "IO_UNK1", IO_UNK1_ADDR, IO_UNK1_LENGHT)
    dummy_map(mc, "IO_UNK2", IO_UNK2_ADDR, IO_UNK2_LENGHT)
    dummy_map(mc, "IO_UNK6", IO_UNK6_ADDR, IO_UNK6_LENGHT)
    dummy_map(mc, "IO_UNK7", IO_UNK7_ADDR, IO_UNK7_LENGHT)
    mc.mem_map(MSG_RAM_ADDR, MSG_RAM_LENGHT) # Dummy map causes boot loop
    dummy_map(mc, "INT_REGS", INT_REGS_ADDR, INT_REGS_LENGHT)
    dummy_map(mc, "SFLU3", SFLU3_ADDR, SFLU3_LENGHT)